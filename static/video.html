<!DOCTYPE html>

<head>
	<title>Natter London</title>
	<link rel="stylesheet" href="css/main.css">
	<!-- Bootstrap -->
	<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"> -->
	<!-- Slick.js (Carousel) -->
	<!-- <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

	<script>
		paceOptions = {
			// Disable the 'elements' source
			ajax: false, // disabled
			document: false, // disabled
			eventLag: false, // disabled
			elements: {
				selectors: ['.my-page']
			},
			// Only show the progress on regular and ajax-y page navigation,
			// not every request
			restartOnRequestAfter: false
		}
	</script>
	<script data-pace-options='{ "ajax": false }' src="js/pace.min.js"></script>
	<link rel="stylesheet" href="css/pace.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/video-js.min.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/vex.css" />
	<link rel="stylesheet" href="css/vex-theme-wireframe.css" />

	<style>
		video {
			border: 3px black;
		}
	</style>
</head>

<body>
	<!-- width="640" height="264"  style="display:none"-->

	<video id="my-video" class="video-js vjs-default-skin vjs-fluid" controls data-setup="{}">
	</video>
	<style>
		#my-video {
			position: absolute;
			height: 100%;
			width: 100%;
			top: 0;
			left: 0;
			z-index: 1050;
		}
		#vid-card {
			z-index: 1051;
		}
	</style>

<div class="fab_container" id="logo-masterfab">
<div class="fab"><span>+</span></div>
</div>


<div class="fab_container" id="home-masterfab">
<div class="fab"><span>+</span></div>
</div>

	<div id="vid-card" class="card" style="display:none">
		<div class="card-block">
			News UK Building | <a href="#"><i class="fa fa-star"></i></a>
		</div>
	</div>

	<nav class="navbar navbar-light bg-light">
		<span class="h1 natter-header text-center">NATTER</span>
	</nav>

	<div class="container-fluid" id='main-content' style="display:none">

		<div class="row">
			<div class="col-sm-12 col-center">

				<div class="card">
					<img class="card-img-top art-img" src="http://via.placeholder.com/300x200" alt="headline image">
					<div class="card-body">
						<p class="subset-text">Culture &#8226; 12 Jan 2017</p>
						<h4 class="card-title">Example Headline Main</h4>
						<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
					</div>
				</div>

			</div>
		</div>

		<hr>

		<div class="row">
			<div class="col-sm-12 col-center">

				<div class="card">
					<img class="card-img-top" src="http://via.placeholder.com/300x200.png/09f/fff" alt="headline image">
					<div class="card-body">
						<p class="subset-text">Culture &#8226; 12 Jan 2017</p>
						<h4 class="card-title">Example Headline</h4>
						<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
					</div>
				</div>

			</div>
		</div>

		<div class="row">
			<div class="col-sm-12 col-center">

				<h4 class="sub-headers">Latest</h4>

				<div class="card">
					<img class="card-img-top art-img" src="http://via.placeholder.com/300x200" alt="headline image">
					<div class="card-body">
						<p class="subset-text">Culture &#8226; 12 Jan 2017</p>
						<h4 class="card-title">Example Headline 4</h4>
						<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
					</div>
				</div>

			</div>
		</div>


		<div class="row">
			<div class="col-sm-12 col-center">

				<div class="card">
					<img class="card-img-top" src="http://via.placeholder.com/300x200.png/09f/fff" alt="headline image">
					<div class="card-body">
						<p class="subset-text">Culture &#8226; 12 Jan 2017</p>
						<h4 class="card-title">Example Headline</h4>
						<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
					</div>
				</div>

			</div>
		</div>
	</div>

	<nav class="navbar fixed-bottom navbar-light bg-faded">
		<div class="icon-bar">
			<a class="active" href="#"><i class="fa fa-home"></i></a>
			<a href="#"><i class="fa fa-search"></i></a>
			<a href="#"><i class="fa fa-globe"></i></a>
		</div>
	</nav>

	<div class="modal fade" id="article-modal">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Modal title</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				  </button>
				</div>
				<div class="modal-body">
					<p>Modal body text goes here.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-primary">Save changes</button>
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>


	<!-- Scripts -->
	<!-- <script src="https://code.jquery.com/jqu<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/tether.min.js"></script>
	<script src="js/bootstrap.min.js"> </script>ery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/usm/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
	<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.min.js"></script> -->
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/tether.min.js"></script>
	<script src="js/bootstrap.min.js">

	</script>
	<script src="js/vex.combined.min.js"></script>
	<script>
		vex.defaultOptions.className = 'vex-theme-wireframe'
	</script>
	</script>
	<script src="js/video.js"></script>
	<script src="js/dash.all.min.js"></script>
	<script src="js/videojs-dash.min.js"></script>

	<script>
		function tether_card() {
			//Creates a new tether for the card
			vid_card = $('#vid-card')
			vid = $('#my-video')
			new Tether({
				element: vid_card,
				target: vid,
				attachment: 'top center',
				targetAttachment: 'top center',
				// targetModifier: 'hidden'
				offset: '-15px 0px',
				enabled: true
			})
		}
		function tether_buttons(params) {
				logo_fab = $('#logo-masterfab')
				home_fab = $('#home-masterfab')

				new Tether({
					element: logo_fab,
					target: vid,
					attachment: 'bottom right',
					targetAttachment: 'top center',
					// targetModifier: 'hidden'
					offset: '-15px 0px',
					enabled: true
				})
				new Tether({
					element: home_fab,
					target: vid,
					attachment: 'center center',
					targetAttachment: 'center center',
					// targetModifier: 'hidden'
					offset: '-15px 0px',
					enabled: true
				})
			}

		$(document).ready(function () {
			main_content = $('#main-content')
			vid = $('#my-video')

			vid_inner = $('.vjs-tech')

			vid.hide()

			vid_card = $('#vid-card')
			tether_card()


			vid_card.click(function (e) {
				e.preventDefault();
				video_player = videojs('my-video');
				if (video_player.paused() == false) {
					video_player.pause()
					vex.dialog.alert({
						unsafeMessage: '<b>Hello World!</b>',
						callback: function (value) {
							video_player.play()
						}
					});
				}
			});

			function show_article(content) {
				$('#article-modal').modal()
			}

			function update_card_text(params) {

			}


			function play_video(url) {
				vid_id = 2
				video_player = videojs('my-video');
				video_player.src(url);
				// debugger;
				video_player.ready(function () {
					$('#my-video').show()
					video_player.play();
					reset_video_activations(vid_id)
					tether_card()
					tether_buttons()
				});


				video_player.on('ended', function () {
					$('#my-video').hide()
					show_article("hi")
					vid_card.hide()

				});

				video_player.on('playing', function () {
					// vid_card.show()
					// vid_card.position()


				});

				video_player.on('timeupdate', function () {
					// vid_card.text(this.currentTime());
					check_time_register(vid_id, this.currentTime())
				})
			}

			videos_time_register = {}

			// Calls a function at a particular time for a particular video
			function register_time_callback(v_id, vtime, callback) {
				if (videos_time_register[v_id]) {
					videos_time_register[v_id].push({
						video_id: v_id,
						video_time: vtime,
						callback: callback,
						activated: false
					})
				} else {
					videos_time_register[v_id] = []
					videos_time_register[v_id].push({
						video_id: v_id,
						video_time: vtime,
						callback: callback,
						activated: false,
					})
				}
			}

			function check_time_register(video_id, currentTime) {
				video_register = videos_time_register[video_id]

				for (var index = 0; index < video_register.length; index++) {
					var item = video_register[index];
					if (item.activated == false) {
						if (currentTime > item.video_time) {
							item.callback(video_id, currentTime)
							videos_time_register[video_id][index].activated = true
						}
					}
				}
			}
			function reset_video_activations(video_id) {
				video_register = videos_time_register[video_id]
				if (video_register) {
					for (var index = 0; index < video_register.length; index++) {
						videos_time_register[video_id][index].activated = false
					}
				}
			}

			function show_card(id, time) {
				// in future get card text from id
				// etc


				// card_details = get_card_details()
				vid_card.show()
				tether_card()
				tether_buttons()
			}


			register_time_callback(2, 1, show_card)



			$('.art-img').click(function (e) {
				e.preventDefault();
				img = e.target
				vid_url = { src: 'https://content.natter-london.com/job2/sophie1.mpd', type: 'application/dash+xml'}
				// vid_url = "https://s3-eu-west-1.amazonaws.com/content.natter-london.com/sophie+video+1.mp4"
				// vid-url = e.attr('url')
				play_video(vid_url)




			});


			//play the intro video
			video_player = videojs('my-video');
			video_player.src("http://s3.eu-west-2.amazonaws.com/natter-london.com/Natter+warm+up.mp4");

			video_player.ready(function () {
				Pace.stop()
				$('#my-video').show()
				video_player.play();
			});

			video_player.on('ended', function () {
				main_content.show()
				$('#my-video').hide()
				// show_article("hi")
				// vid_card.hide()

			});

			video_player.on('playing', function () {
				// vid_card.show()
				// vid_card.position()


			});

			// video_player.on('timeupdate', function () {
			// 	// vid_card.text(this.currentTime());
			// 	check_time_register(vid_id, this.currentTime())
			// })


			

			



		});
			// Injected fab button
			</script>

</body>